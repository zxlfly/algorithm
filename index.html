<script>
    let i = left;
    let l = mid + 1;
    let r = mid + 1;
    while (i <= mid) {
        while (l <= right && sum[l] - sum[i] < lower) l++;
        while (r <= right && sum[r] - sum[i] <= upper) r++;
        ret += (r - l);
        i++;
    }

</script>